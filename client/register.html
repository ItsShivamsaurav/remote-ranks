<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Register - Peer Study</title>
  <link rel="stylesheet" href="css/style.css">
</head>
<body>
<header><h1>Create account</h1></header>
<main>
  <div class="card">
    <form id="regForm">
      <label>Name</label><input name="name" required>
      <label>Email</label><input name="email" type="email" required>
      <label>Password</label><input name="password" type="password" required>
      <label>Bio (optional)</label><textarea name="bio"></textarea>
      <button type="submit">Register</button>
    </form>
    <p id="msg" class="muted"></p>
  </div>
</main>
<script type="module">
import { api, setToken } from './js/main.js';
const form = document.getElementById('regForm');
const msg = document.getElementById('msg');
form.addEventListener('submit', async (e) => {
  e.preventDefault();
  const payload = Object.fromEntries(new FormData(form).entries());
  try {
    const { token } = await api('/auth/register', { method: 'POST', body: JSON.stringify(payload) });
    setToken(token);
    window.location.href = 'dashboard.html';
  } catch (err) { msg.textContent = err.message; }
});
</script>
</body>
</html>
